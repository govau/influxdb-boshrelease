---
name: influxdb

templates:
  influxd_ctl.erb: bin/influxd_ctl
  influxdb.conf.erb: config/influxdb.conf
  https_cert.pem.erb: config/https_cert.pem

packages:
- influxdb
- bootstrapper

provides:
  - name: influxdb
    type: influxdb
    properties:
      - influxdb.database
      - influxdb.user
      - influxdb.password
      - influxdb.http.port
      - influxdb.http.tls.cert.ca

properties:
  influxdb.auth_enabled:
    description: |
      Is authentication required?
    default: false
  influxdb.database:
    description: "database name in influxdb to create"
  influxdb.user:
    default: "root"
    description: "influx user"
  influxdb.password:
    default: "root"
    description: "influx user's password"
  influxdb.retention:
    default: "14d"
    description: "default retention period for database"
  influxdb.replication:
    default: "1"
    description: "default replication count for database"

  influxdb.udp.enabled:
    default: false
    description: "enable udp service"
  influxdb.udp.bind_address:
    default: ":8089"
    description: "udp service bind address"

  influxdb.data.index_version:
    description: |
      The type of shard index to use for new shards.
    default: inmem
  influxdb.data.max_values_per_tag:
    description: |
      The maximum number of tag values allowed per tag key.
  influxdb.data.max_series_per_database:
    description: |
      The maximum number of series allowed per database.

  influxdb.http.log_enabled:
    description: "enable logging of http queries"
    default: false
  influxdb.http.tls.enabled:
    description: |
      Set to true to listen on https rather than http.
    default: false
  influxdb.http.tls.cert:
    description: |
      Certficate to present. Typically generated by bosh variables.
    default: false
    example:
      ca: |
        ----- BEGIN CERTIFICATE -----
        ...
        ----- END CERTIFICATE -----
      certificate: |
        ----- BEGIN CERTIFICATE -----
        ...
        ----- END CERTIFICATE -----
      private_key: |
        ----- BEGIN PRIVATE KEY -----
        ...
        ----- END PRIVATE KEY -----
  influxdb.http.port:
    description: "http(s) port to listen on"
    default: 8086
